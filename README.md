# Vision_Defect_Detector

## 프로젝트 개요

### 산업용 머신비전을 활용한 결함 감지 시스템. 
   
서보모터가 돌아가면서 결함이 새겨진 피사체를 회전시키고, 비전에 나타난 피사체의 결함을 인식하여 결함의 개수를 카운트 하는 프로그램입니다.
이를 위해 OpenCV 라이브러리에서 제공하는 이미지 처리함수, Camera API를 활용했습니다.


## 프로젝트 배경

처음 기획의도는 지금 가지고 있는 웹캠으로 구현하는 것 이었습니다.
산업용 머신비전의 카메라의 경우 가격도 비싸고, 후술하겠지만 연결방식도 일반적인 USB 단자를 가진 웹캠에 비해서 복잡한 방식으로 구현해야 합니다.
하지만 설비 S/W를 다루게 된다면 익숙해져야 할 부분이고, 비전과 컴퓨터를 연결만 할 수 있다면 그 이후 구현에선 많은 자료가 있으므로 해볼만한 프로젝트라고 생각하였습니다.

개발기간은 대략 40일 정도 소요되었습니다. 가장 큰 부분은 준비물 선정과, 특히 산업용 렌즈의 경우 해외배송 건이라 2주가 넘는 시간이 소요되었습니다. 그 2주의 기간 동안 웹캠을 활용하여
개발을 하였고(Machine_Vision_Pre 레포지토리 참조) OpenCV, Visual Studio 개발환경에 익숙해지려고 노력했습니다. 또한 일찍 배송이 된 아두이노 세트를 가지고 모션 쪽 구현을 미리 진행하였습니다.

렌즈가 도착하고, 렌즈를 가지고 있던 머신비전 카메라에 부착하고 본격적인 개발을 시작하였습니다. Camera 제조사에서 제공한 SDK를 설치한 후에 작동을 확인하고 API를 통해 연결을 구현하였습니다.
렌즈부착 -> Visual Studio 구현 코드로 연결확인까지 대략 5일이 소요되었습니다. 

이후 아두이노 보드와 통신하는 부분과 Defect 감지 부분을 구현했습니다.
   

## H/W 선정

| No.    | 이름        | 모델명        | 가격      | 비고      |
|--------|-------------|---------------|----------|-----------|
| 1 | Machine Vision Camera      |     HIKROBOT-MV-CS200-10GM    | 89,000원 | Used, GigE |
| 2 | Camera Lens       | FUJINON HF16HA-1B 고정 초점 산업용 렌즈       | 72,280원 | Used, 16mm |
| 3 | Servo Motor, Board, Connector        | 아두이노 우노 R3 초보자 키트    | 24,200원 | - |
| 4 | POE Injector      | TP Link TL-POE150S        | 15,900원 | - |
| 5 | Lan Cable(Cat 6)      | LD-GPST/BU20-D        | 5,000원 | - |
| 6 | 기타      | 조명(보유 중인 LED 조명), 클램프        | - | - |
| - | Total      | -       | 206,380원 | - |

비전과 카메라 파트의 재료선정은 가격을 최우선으로 생각하였습니다. 그리고 카메라의 경우 프레임 그레버 타입과 GigE 타입이 있었는데
가지고 있는 PC가 노트북이고, 가격역시 프레임 그레버 카드가 고가에, 호환성 여부를 확신할 수 없었으므로 길게 고민하지 않고 랜선으로 연결되는 GigE 타입의 
HIKROBOT-MV-CS200-10GM을 선정하였습니다. 구매처는 리사이클 메카입니다.

렌즈의 경우 위 카메라와 호환되는 C-마운트 렌즈 중에서 대략 30~50cm 정도의 초점거리에서 촬영가능한 렌즈로 선정하였습니다. 
산업용 렌즈에서 주로 쓰이는 초점거리 12mm와 16mm 카메라 렌즈를 고려하였고, 계획된 피사체의 결함크기가 크지 않은것을 고려하여 16mm 렌즈를 선정하였습니다. 
해당 모델의 선정은 가격을 우선시하여 선정하였고, 지마켓에서 중고물품으로 구매하였습니다.

나머지 다른 물품들은 인터넷 및 오프라인 매장에서 쉽게 구매하였습니다. LAN Cable은 단거리 연결에서 CAT 버전은 크게 의미가 없으므로 시중에서 가장 싼 제품을 고르시면 됩니다.


## H/W 연결

1. Vision: 노트북 혹은 가정용 PC에 GigE 타입의 머신비전 카메라를 연결할 때 중요한 것은 랜선을 통해 파워를 공급하는 것 입니다.
   이때 필요한 요소가 파워를 공급해주는 POE 인젝터입니다. 







## 프로젝트 구조

## 설치 및 실행방법
### Vision
### Arduino

## 코드

## 실제 구동장면

## 참고자료
